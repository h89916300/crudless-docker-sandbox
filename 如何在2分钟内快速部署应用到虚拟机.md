# 如何在2分钟内快速部署应用到虚拟机

> 文档假定开发需求测试**当前应用的前后端服务**，并快速部署到虚机进行测试或演示
>>  应用名称为  `iot`, 服务器暴露的测试端口为 `8000`, 数据库名称用 `test`

## 服务端则部署
> 用户登录进入虚拟机（服务器）进行部署

#### 获取docker部署模板
```shell
$ git clone https://github.com/kequandian/cloudapp-docker-starter.git  iot
```

#### 准备API安装包 
> 在本地 `mvn package` 生成 `iot-1.0.0-standalone.jar`, 并通过`scp`传至相应目录
```shell
$ ls ~/iot/api/api-1.0.0-standalone.jar
api-1.0.0-standalone.jar
```

#### 准备 web dist
> 在本地 `npm buil` 生成 `dist`，并通过scp上传至相应目录
```shell
$ ls ~/iot/web
dist
```

#### 先进行绿地部署
```shell
$ sh greenfield.sh
Usage: greenfield.sh <app> <port> <database>
Option:
    app       - app name a.w.a. prefix of docker container name
    port      - expose port from host
    database  - database name

$ sh greenfield.sh iot 8000 test
  com.jfeat.AmApplication : Test SaaS is success!
```
> Ctrl+C 停掉运行的容器

#### 正式部署 
```shell
$ cd ~/iot
$ docker-compose up   ## 可实时查看log
$ # docker-compose up -d  ## 应用后台运行
```


## 本地部署
> 
